---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PostCard from "../../components/PostCard.astro";
import { getCollection } from "astro:content";

const allPosts = await getCollection("editorial", ({ data }) => !data.draft);
const posts = allPosts.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
);
const featuredPosts = posts.filter((post) => post.data.featured);
const regularPosts = posts.filter((post) => !post.data.featured);
---

<BaseLayout
  title="Editorial | LaTech Editorial Publishing"
  description="Read thoughtful editorial content including opinion pieces, analysis, and commentary on publishing, scholarship, and public knowledge."
>
  <div class="page-header">
    <div class="container">
      <h1>Editorial</h1>
      <p class="page-subtitle">Opinion, analysis, and commentary</p>
    </div>
  </div>

  <div class="page-content">
    <div class="container">
      <div class="intro-text">
        <p>
          Our editorial content bridges academic research and public
          understanding, offering thoughtful analysis, commentary, and opinion
          on issues related to scholarship, publishing, and knowledge
          accessibility.
        </p>
      </div>

      {
        featuredPosts.length > 0 && (
          <section class="featured-section">
            <h2>Featured Articles</h2>
            <div class="posts-grid">
              {featuredPosts.map((post) => (
                <PostCard
                  title={post.data.title}
                  description={post.data.description}
                  date={post.data.date}
                  author={post.data.author}
                  tags={post.data.tags}
                  url={`/editorial/${post.slug}/`}
                  readingTime={post.data.readingTime}
                  featured={post.data.featured}
                />
              ))}
            </div>
          </section>
        )
      }

      <section class="all-posts-section">
        {featuredPosts.length > 0 && <h2>All Articles</h2>}
        <div class="posts-grid">
          {
            regularPosts.map((post) => (
              <PostCard
                title={post.data.title}
                description={post.data.description}
                date={post.data.date}
                author={post.data.author}
                tags={post.data.tags}
                url={`/editorial/${post.slug}/`}
                readingTime={post.data.readingTime}
                featured={post.data.featured}
              />
            ))
          }
        </div>
      </section>
    </div>
  </div>
</BaseLayout>

<style>
  .page-header {
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
    color: var(--color-white);
    padding: var(--spacing-3xl) var(--spacing-lg);
    text-align: center;
    position: relative;
    margin-bottom: var(--spacing-2xl);
    overflow: hidden;
  }

  .page-header .container {
    max-width: var(--max-layout-width);
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  .page-header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      circle at top right,
      rgba(212, 106, 67, 0.2) 0%,
      transparent 70%
    );
    pointer-events: none;
  }

  .page-header::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent 0%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 100%
    );
  }

  .page-header h1 {
    color: var(--color-white);
    margin-bottom: var(--spacing-lg);
    font-size: clamp(var(--font-size-3xl), 5vw, var(--font-size-5xl));
    position: relative;
    z-index: 1;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    letter-spacing: -0.02em;
  }

  .page-subtitle {
    font-size: clamp(var(--font-size-lg), 2vw, var(--font-size-xl));
    opacity: 0.95;
    margin: 0 auto;
    font-weight: 400;
    font-style: italic;
    position: relative;
    z-index: 1;
    font-family: var(--font-serif);
    line-height: 1.5;
    text-align: center;
    max-width: 600px;
  }

  .page-content {
    padding: var(--spacing-2xl) 0 var(--spacing-3xl);
    background-color: var(--color-bg);
    min-height: 60vh;
  }

  .page-content .container {
    max-width: var(--max-layout-width);
    margin: 0 auto;
    padding: 0 var(--spacing-lg);
  }

  .intro-text {
    max-width: 800px;
    margin: 0 auto var(--spacing-3xl);
    text-align: center;
    font-size: clamp(var(--font-size-base), 2vw, var(--font-size-xl));
    color: var(--color-text);
    line-height: 1.75;
    padding: var(--spacing-xl);
    background-color: var(--color-white);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--color-border-light);
  }

  .intro-text p {
    margin: 0;
    font-family: var(--font-serif);
    font-style: italic;
    color: var(--color-text-light);
  }

  .featured-section,
  .all-posts-section {
    margin-bottom: var(--spacing-3xl);
    padding: var(--spacing-xl) 0;
  }

  .featured-section {
    background-color: var(--color-white);
    padding: var(--spacing-2xl);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-sm);
    margin-bottom: var(--spacing-3xl);
  }

  .featured-section h2,
  .all-posts-section h2 {
    margin-bottom: var(--spacing-xl);
    font-size: clamp(var(--font-size-2xl), 3vw, var(--font-size-3xl));
    color: var(--color-primary);
    font-family: var(--font-serif);
    position: relative;
    padding-bottom: var(--spacing-md);
    border-bottom: 3px solid var(--color-accent);
    display: inline-block;
    width: 100%;
  }

  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(min(340px, 100%), 1fr));
    gap: var(--spacing-xl);
    margin-top: var(--spacing-xl);
  }

  @media (max-width: 768px) {
    .page-header {
      padding: var(--spacing-2xl) var(--spacing-md);
    }

    .page-header h1 {
      margin-bottom: var(--spacing-md);
    }

    .posts-grid {
      grid-template-columns: 1fr;
    }
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
